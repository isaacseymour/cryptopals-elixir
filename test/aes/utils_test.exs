defmodule AES.UtilsTest do
  use ExUnit.Case, async: true
  import AES.Utils

  test "sub_bytes" do
    assert sub_bytes([0x53]) == [0xed]
  end

  test "shift_rows" do
    input = [
      0x01, 0x05, 0x09, 0x0d,
      0x02, 0x06, 0x0a, 0x0e,
      0x03, 0x07, 0x0b, 0x0f,
      0x04, 0x08, 0x0c, 0x10
    ]
    expected = [
      0x01, 0x06, 0x0b, 0x10,
      0x02, 0x07, 0x0c, 0x0d,
      0x03, 0x08, 0x09, 0x0e,
      0x04, 0x05, 0x0a, 0x0f
    ]

    assert shift_rows(input) == expected
  end
end
